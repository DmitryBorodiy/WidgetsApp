<c:Widget
    x:Class="BetterWidgets.Widgets.ClockWidget"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:BetterWidgets.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:h="clr-namespace:BetterWidgets.Helpers"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:r="clr-namespace:BetterWidgets.Resources"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vm="clr-namespace:BetterWidgets.ViewModel.Widgets"
    x:Name="Root"
    Width="250"
    Height="160"
    MinWidth="120"
    MinHeight="120"
    d:DesignHeight="250"
    d:DesignWidth="250"
    AppearedCommand="{Binding AppearedCommand}"
    AppearedCommandParameter="{Binding ElementName=Root}"
    CanShare="{Binding CanShare, Mode=OneWay}"
    IsHideTitleBar="True"
    IsTitleBarEnabled="True"
    MouseEnterCommand="{Binding MouseEnterCommand}"
    MouseLeaveCommand="{Binding MouseLeaveCommand}"
    PinnedCommand="{Binding PinnedCommand}"
    ShareCommand="{Binding ShareCommand}"
    StateChangedCommand="{Binding ExecutionStateChangedCommand}"
    Style="{StaticResource DefaultWidgetStyle}"
    UnpinCommand="{Binding UnpinCommand}"
    mc:Ignorable="d">
    <c:Widget.DataContext>
        <vm:ClockWidgetViewModel />
    </c:Widget.DataContext>
    <c:Widget.TitleBar>
        <c:WidgetTitleBar
            x:Name="TitleBarUI"
            Grid.Row="0"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Top"
            Background="Transparent"
            CloseCommand="{Binding CloseCommand}"
            IconVisibility="Collapsed"
            IsPinned="{Binding Widget.IsPinned, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
            TitleVisibility="Collapsed" />
    </c:Widget.TitleBar>
    <c:Widget.ContextMenu>
        <ContextMenu>
            <ui:MenuItem
                Command="{Binding ShareCommand}"
                Header="{x:Static r:Resources.ShareLabel}"
                Visibility="{Binding CanShare, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                <ui:MenuItem.Icon>
                    <ui:SymbolIcon Symbol="Share20" />
                </ui:MenuItem.Icon>
            </ui:MenuItem>
            <ui:MenuItem Command="{Binding LaunchSettingsCommand}" Header="{x:Static r:Resources.SettingsLabel}">
                <ui:MenuItem.Icon>
                    <ui:SymbolIcon Symbol="Settings20" />
                </ui:MenuItem.Icon>
            </ui:MenuItem>
        </ContextMenu>
    </c:Widget.ContextMenu>

    <Grid x:Name="RootLayout" d:Margin="0">
        <Rectangle
            Fill="#07000000"
            Opacity="0.1"
            Visibility="{Binding IsBackgroundDisabled, Converter={StaticResource BoolToVisibility}}" />
        <Viewbox
            Margin="10,13"
            HorizontalAlignment="Center"
            VerticalAlignment="Stretch">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <ui:TextBlock
                    Grid.Row="0"
                    Grid.Column="1"
                    MaxWidth="100"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    d:Text="Moscow time"
                    d:Visibility="Visible"
                    FontSize="12"
                    Text="{Binding TimeZoneTitle, Mode=OneWay}"
                    TextAlignment="Center"
                    TextTrimming="CharacterEllipsis"
                    Visibility="{Binding IsLocalTimezone, Mode=OneWay, Converter={StaticResource BoolToVisibilityInvert}}" />

                <Grid
                    Name="DigitalClockUI"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="6,5,6,10"
                    d:Visibility="Collapsed"
                    Visibility="{Binding IsDigitalClockVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <ui:Button
                        Grid.Row="0"
                        HorizontalAlignment="Center"
                        Command="{Binding LaunchUriCommand}"
                        CommandParameter="ms-clock:"
                        Style="{StaticResource FlatButton}"
                        ToolTipService.ToolTip="{x:Static r:Resources.OpenClockAlarms}">
                        <ui:TextBlock
                            Margin="8,-5,8,0"
                            d:Text="06:00 AM"
                            Effect="{Binding Shadow, Mode=OneWay}"
                            FontFamily="{Binding DefaultFont, Mode=OneWay}"
                            FontSize="35"
                            FontWeight="SemiBold"
                            Text="{Binding Time, Mode=OneWay}"
                            TextAlignment="Center"
                            TextTrimming="CharacterEllipsis" />
                    </ui:Button>
                    <ui:Button
                        Grid.Row="1"
                        Padding="9,0,9,1"
                        HorizontalAlignment="Center"
                        Command="{Binding LaunchUriCommand}"
                        CommandParameter="ms-actioncenter:"
                        Style="{StaticResource FlatButton}"
                        ToolTipService.ToolTip="{x:Static r:Resources.OpenCalendar}"
                        Visibility="{Binding IsDateEnabled, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                        <ui:TextBlock
                            d:Text="Thursday, April 24"
                            Effect="{Binding Shadow, Mode=OneWay}"
                            FontFamily="{Binding DefaultFont, Mode=OneWay}"
                            FontSize="15"
                            Opacity="0.8"
                            Text="{Binding Date, Mode=OneWay}"
                            TextAlignment="Center"
                            TextTrimming="CharacterEllipsis" />
                    </ui:Button>
                </Grid>

                <Grid
                    Name="AnalogClockUI"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="6,0,6,5"
                    Visibility="{Binding IsAnalogClockVisible, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <c:AnalogClock
                        Grid.Row="1"
                        Margin="0,5,0,0"
                        d:DateTime="04/28/2025 20:20:45"
                        DateTime="{Binding DateTime, Mode=OneWay}"
                        Effect="{Binding Shadow, Mode=OneWay}"
                        FontFamily="{Binding DefaultFont, Mode=OneWay}"
                        IsClockFaceEnabled="{Binding IsClockFaceEnabled, Mode=OneWay}"
                        IsSecondsArrowEnabled="True" />
                    <StackPanel
                        Grid.Row="1"
                        Margin="0,45,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        RenderTransformOrigin="0.5,0.5">
                        <ui:Button
                            Grid.Row="1"
                            MaxWidth="80"
                            Padding="2,0,2,0"
                            HorizontalAlignment="Center"
                            Command="{Binding LaunchUriCommand}"
                            CommandParameter="ms-actioncenter:"
                            Style="{StaticResource FlatButton}"
                            ToolTipService.ToolTip="{x:Static r:Resources.OpenCalendar}"
                            Visibility="{Binding IsDateEnabled, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                            <ui:TextBlock
                                Margin="0,0,0,-8"
                                d:Text="Thursday, April 24"
                                Effect="{Binding Shadow, Mode=OneWay}"
                                FontFamily="{Binding DefaultFont, Mode=OneWay}"
                                FontSize="9"
                                Opacity="0.8"
                                Text="{Binding Date, Mode=OneWay}"
                                TextAlignment="Center"
                                TextTrimming="CharacterEllipsis" />
                        </ui:Button>
                    </StackPanel>
                </Grid>

                <ui:Button
                    Grid.Row="3"
                    Grid.Column="1"
                    MaxWidth="135"
                    Margin="2,0,2,0"
                    Padding="8,2"
                    HorizontalAlignment="Center"
                    Command="{Binding LaunchAppointmentCommand}"
                    CommandParameter="{Binding Appointment, Mode=OneWay}"
                    RenderTransformOrigin="0.5,0.5"
                    Style="{StaticResource FlatButton}"
                    Visibility="{Binding ShowAppointment, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                    <ui:Button.RenderTransform>
                        <ScaleTransform ScaleX="1.3" ScaleY="1.3" />
                    </ui:Button.RenderTransform>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Ellipse
                            Grid.Column="0"
                            Width="6"
                            Height="6"
                            VerticalAlignment="Center"
                            Fill="{Binding Appointment.StatusColor, Mode=OneWay}"
                            Opacity="0.6" />
                        <StackPanel
                            Grid.Column="1"
                            Margin="6,0,0,-5"
                            VerticalAlignment="Center">
                            <ui:TextBlock
                                Margin="0,-2"
                                FontSize="9"
                                Text="{Binding Appointment.TitleLabel, Mode=OneWay}"
                                TextTrimming="CharacterEllipsis" />
                            <Grid Margin="0,-5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <ui:TextBlock
                                    Grid.Column="0"
                                    HorizontalAlignment="Left"
                                    FontSize="8"
                                    Opacity="0.8"
                                    Text="{Binding Appointment.StartTimeLabel, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis" />
                                <Separator
                                    Grid.Column="1"
                                    Height="5"
                                    Margin="1,-4,1,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Stretch" />
                                <ui:TextBlock
                                    Grid.Column="2"
                                    HorizontalAlignment="Left"
                                    FontSize="8"
                                    Opacity="0.8"
                                    Text="{Binding Appointment.EndTimeLabel, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis" />
                            </Grid>
                        </StackPanel>
                    </Grid>
                </ui:Button>

                <ui:Button
                    Name="PreviousClockButton"
                    Grid.RowSpan="3"
                    Grid.Column="0"
                    Padding="1"
                    VerticalAlignment="Center"
                    d:Visibility="Collapsed"
                    Command="{Binding PreviousTimeZoneCommand}"
                    IsEnabled="{Binding HasPreviousTimeZone, Mode=OneWay}"
                    Style="{StaticResource FlatButton}"
                    Visibility="{Binding HasTimeZones, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                    <ui:Button.Icon>
                        <ui:SymbolIcon FontSize="20" Symbol="ChevronLeft20" />
                    </ui:Button.Icon>
                </ui:Button>
                <ui:Button
                    Name="NextClockButton"
                    Grid.RowSpan="3"
                    Grid.Column="2"
                    Padding="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    d:Visibility="Collapsed"
                    Command="{Binding NextTimeZoneCommand}"
                    IsEnabled="{Binding HasNextTimeZone, Mode=OneWay}"
                    Style="{StaticResource FlatButton}"
                    Visibility="{Binding HasTimeZones, Mode=OneWay, Converter={StaticResource BoolToVisibility}}">
                    <ui:Button.Icon>
                        <ui:SymbolIcon FontSize="20" Symbol="ChevronRight20" />
                    </ui:Button.Icon>
                </ui:Button>
            </Grid>
        </Viewbox>
    </Grid>

</c:Widget>
